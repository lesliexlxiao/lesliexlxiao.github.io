# [笔记]搭建可靠性系统工程实践


本文主要是看了携程集团商旅事业部的 CTO 宋涛在极客时间上《搭建可靠性系统工程实践》的分享而做的一些笔记及总结。

## 1. 可靠性：互联网时代的挑战
关于系统可靠性，业界常用 3 个 9、4 个 9，来计算每年的服务故障时间，从而去衡量系统的可靠性。怎么计算的？
  - 3 个 9：(1 - 99.9%) * 365 * 24 = 8.76 小时，表示该系统在连续运行 1 年时间里最多可能的业务中断时间是 8.76 小时。
  - 4 个 9：(1 - 99.99%) * 365 * 24 = 0.876 小时 = 52.6 分钟，表示该系统在连续运行 1 年时间里最多可能的业务中断时间是 52.6 分钟。

一般头部互联网公司对他们的关键服务，通常提出的承诺是 4 个 9，也就是<font color=FF0099>**每年最多故障 53 分钟**</font>。

出现系统故障，亚马逊是以自己常用的 6 页纸的复盘文档形式展现给大家，个人觉得这是一种比较好的方式。通过 6 页纸，你能知道是什么原因触发了什么系统故障，它的影响为什么会进一步放大，整个技术团队做了什么去控制影响。

亚马逊某次故障总结：https://aws.amazon.com/message/11201/

## 2. CNCF 带来的改变
CNCF：全称 Cloud Native Computing Foundation（云原生计算基金会）。

## 3. 影响可靠性的因素
影响半径或者爆炸半径（Blast Radius）：指的是 Bug、事故能让多少系统停止服务。

ROI：投资回报率。

## 4. 不同公司的做法
Code Review

Design Review：设计评审

OPS Review

SOP：操作规范

## 5. 故障分享
War Room：通常指某个事件升级了，大家需要进入一个 War Room 的事件升级状态。War Room 是一些互联网公司在处理大型事故当中总结出来比较有效的方式，就是当大规模事件发生的时候，会把一些骨干技术负责人集中在一间房子里，大家再指挥下边一批人去工作。这种情况下，会有一个人负责对更高一层的人做沟通和决策，整体来说大家各司其职，比较有效率。

## 6. 携程商旅实践
“Quality is not an act，it is a habit”，质量都是日常习惯所产生的后果。

Design for failure，需要对我们的 Design 模板明确要求加哪些监控，怎么去报警，系统失败了怎么办？

对事故复盘有非常详细的 COE 记载，COE 就是复盘报告，包括整个故障的时间、花了多久解决、代码有哪些缺陷是可以共享的。

几类监控
  - 生产维度的数据监控
  - 系统数据监控
  - 关键系统增加流量、成功率以及延时这种 SRE 黄金三元素的监控
  - 在流程或者功能上基于现象的监控，只要出现了问题，没有及时监控，就要补充监控

## 7. 参考文档
[1] https://time.geekbang.org/column/article/329756.
